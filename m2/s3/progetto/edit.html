<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Edit Product</h1>

    <div class="container">
        <form>
            <input type="text" id="name" required class="form-control" placeholder="Nome prodotto">
            <input type="text" id="brand" required class="form-control" placeholder="Modello">
            <input type="number" id="price" required class="form-control" placeholder="0$">
            <input type="text" id="imageUrl" required class="form-control" placeholder="url immagine">
            <input type="area-text" id="description" required class="form-control" placeholder="Descrizione">
            <button id="reset" class="btn btn-success">Reset</button>
            <button id="save" class="btn btn-success">Save</button>
        </form>
    </div>


    <script>
        
        let url = new URLSearchParams(location.search)
        let id = url.get('id')

        fetch(`https://striveschool-api.herokuapp.com/api/product/${id}`,{
                method:'POST',
                headers:{
                    Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NWVhZDg5NjJkN2IxMTAwMTkwZTZkZGYiLCJpYXQiOjE3MDk4ODk2ODYsImV4cCI6MTcxMTA5OTI4Nn0.Ms-65vg0maL58ibQeKeoCy1NpvSF22TKOEGK5O36rP8",
                    'Content-Type':'application/json'
                }
            })
        .then(res => res.json())
        .then(phone => {
            
            let name = document.querySelector('#name')
            let brand = document.querySelector('#brand')
            let price = document.querySelector('#price')
            let imageUrl = document.querySelector('#imageUrl')
            let description = document.querySelector('#description')
            
            name.value = phonbrand
            brand.value = phone.brand
            price.value = phone.price
            imageUrl.value = phone.imageUrl
            description.value = phone.description
            
        })

        const save =  document.querySelector('#save')

        save.addEventListener('click',function(e){
            e.preventDefault()

            let name = document.querySelector('#name').value
            let brand = document.querySelector('#brand').value
            let price = document.querySelector('#price').value
            let imageUrl = document.querySelector('#imageUrl').value
            let description = document.querySelector('#description').value

            let phone = {
                name,
                brand,
                price,
                imageUrl,
                description
            }

            fetch(`https://striveschool-api.herokuapp.com/api/product/${id}`,{
                method:'PUT',
                headers:{
                    Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NWVhZDg5NjJkN2IxMTAwMTkwZTZkZGYiLCJpYXQiOjE3MDk4ODk2ODYsImV4cCI6MTcxMTA5OTI4Nn0.Ms-65vg0maL58ibQeKeoCy1NpvSF22TKOEGK5O36rP8",
                    'Content-type':'application/json'
                },
                body:JSON.stringify(phone)
            })
            .then(res => res.json())
            .then(res => {

                location.href = 'index.html'

            })

        })
    </script>
</body>
</html>